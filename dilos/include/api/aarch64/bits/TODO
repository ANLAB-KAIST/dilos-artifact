This is just tentative, testing needed.

Note the big XXX hack XXX in float.h!
